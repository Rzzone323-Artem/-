<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>üîê –ó–ê–ö–ê–ó–´ - –ß–£–î–û-–ë–ê–ó–ê–† "–°–≤—è—Ç–æ–π –ê–ª—Ç–∞—Ä—å"</title>
<link rel="stylesheet" href="style.css">
<script src="simple-setup.js"></script>
<style>
body {
    background: #000;
    color: #0F0;
    font-family: "Courier New", monospace;
    padding: 20px;
}

.order-item {
    background: rgba(75, 0, 130, 0.1);
    border: 2px solid #4B0082;
    padding: 15px;
    margin: 10px 0;
    border-radius: 8px;
    position: relative;
}

.order-time {
    color: #FF0;
    font-size: 12px;
    margin-bottom: 5px;
}

.order-field {
    margin: 5px 0;
}

.order-field strong {
    color: #8a2be2;
}

.order-message {
    color: #C0C0C0;
    font-style: italic;
    margin-top: 10px;
    padding: 10px;
    background: rgba(0, 0, 0, 0.3);
    border-left: 3px solid #ff0066;
}

.delete-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background: #800;
    color: #FFF;
    border: none;
    padding: 5px 10px;
    cursor: pointer;
    border-radius: 3px;
}

.delete-btn:hover {
    background: #A00;
}

.admin-only {
    background: rgba(255, 0, 0, 0.1);
    border: 2px solid #F00;
    padding: 20px;
    margin: 20px 0;
    text-align: center;
    border-radius: 8px;
}

.clear-all-btn {
    background: linear-gradient(45deg, #800, #400);
    color: #FFF;
    border: 2px solid #F00;
    padding: 10px 20px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    margin: 10px;
    border-radius: 5px;
    text-transform: uppercase;
}

.clear-all-btn:hover {
    background: linear-gradient(45deg, #A00, #600);
    transform: scale(1.05);
}
</style>
</head>

<body>

<div class="admin-only">
<h2>üîê –ü–ê–ù–ï–õ–¨ –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê</h2>
<p>–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É —Å–∞–π—Ç–∞</p>
<p>–í—Å–µ –∑–∞–∫–∞–∑—ã –∏ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∏–∂–µ</p>
<button class="clear-all-btn" onclick="clearAllOrders()">üóëÔ∏è –û–ß–ò–°–¢–ò–¢–¨ –ó–ê–ö–ê–ó–´</button>
<button class="clear-all-btn" onclick="clearAllMessages()">üóëÔ∏è –û–ß–ò–°–¢–ò–¢–¨ –°–û–û–ë–©–ï–ù–ò–Ø</button>
<button class="clear-all-btn" onclick="clearAll()">üóëÔ∏è –û–ß–ò–°–¢–ò–¢–¨ –í–°–Å</button>
</div>

<hr>

<h2>üì¶ –ó–ê–ö–ê–ó–´ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô</h2>

<div id="ordersList">
<p style="color: #FF0;">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤...</p>
</div>

<hr>

<h2>üí¨ –°–û–û–ë–©–ï–ù–ò–Ø –ù–ê –ú–û–î–ï–†–ê–¶–ò–Æ</h2>

<div id="messagesList">
<p style="color: #FF0;">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π...</p>
</div>

<script>
// –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤ –∏–∑ Google Sheets (–ø—Ä–æ—Å—Ç–∞—è –≤–µ—Ä—Å–∏—è)
async function loadOrders() {
    const ordersList = document.getElementById('ordersList');
    ordersList.innerHTML = '<p style="color: #FF0;">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤...</p>';
    
    try {
        const orders = await window.simpleSheets.getOrders();
        
        if (orders.length > 0) {
            ordersList.innerHTML = orders.map((order, index) => `
                <div class="order-item">
                    <div class="order-time">üìÖ ${order[0]}</div>
                    <div class="order-field"><strong>üë§ –ò–º—è:</strong> ${order[1]}</div>
                    <div class="order-field"><strong>üìß Email:</strong> ${order[2]}</div>
                    <div class="order-field"><strong>üì¶ –¢–æ–≤–∞—Ä:</strong> ${order[3]}</div>
                    <div class="order-message"><strong>üí¨ –°–æ–æ–±—â–µ–Ω–∏–µ:</strong> ${order[4]}</div>
                </div>
            `).join('');
        } else {
            ordersList.innerHTML = '<p style="color: #FF0;">–ó–∞–∫–∞–∑–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>';
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤:', error);
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ localStorage –∫–∞–∫ –±—ç–∫–∞–ø
        const orders = JSON.parse(localStorage.getItem('siteOrders') || '[]');
        if (orders.length > 0) {
            ordersList.innerHTML = orders.map((order, index) => `
                <div class="order-item">
                    <button class="delete-btn" onclick="deleteOrder(${index})">‚ùå</button>
                    <div class="order-time">üìÖ ${order.date}</div>
                    <div class="order-field"><strong>üë§ –ò–º—è:</strong> ${order.name}</div>
                    <div class="order-field"><strong>üìß Email:</strong> ${order.email}</div>
                    <div class="order-field"><strong>üì¶ –¢–æ–≤–∞—Ä:</strong> ${order.product}</div>
                    <div class="order-message"><strong>üí¨ –°–æ–æ–±—â–µ–Ω–∏–µ:</strong> ${order.message}</div>
                </div>
            `).join('');
        } else {
            ordersList.innerHTML = '<p style="color: #FF0;">–ó–∞–∫–∞–∑–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>';
        }
    }
}

// –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é (–ø—Ä–æ—Å—Ç–∞—è –≤–µ—Ä—Å–∏—è)
async function loadMessages() {
    const messagesList = document.getElementById('messagesList');
    messagesList.innerHTML = '<p style="color: #FF0;">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π...</p>';
    
    try {
        const messages = await window.simpleSheets.getMessages();
        
        if (messages.length > 0) {
            messagesList.innerHTML = messages.map((message, index) => `
                <div class="message-item">
                    <div class="message-time">üìÖ ${message[0]}</div>
                    <div class="message-field"><strong>üë§ –ê–≤—Ç–æ—Ä:</strong> ${message[1]}</div>
                    <div class="message-field"><strong>üìù –ó–∞–≥–æ–ª–æ–≤–æ–∫:</strong> ${message[2]}</div>
                    <div class="message-field"><strong>üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> ${message[3]}</div>
                    <div class="message-content"><strong>üí¨ –¢–µ–∫—Å—Ç:</strong> ${message[4]}</div>
                </div>
            `).join('');
        } else {
            messagesList.innerHTML = '<p style="color: #FF0;">–°–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –Ω–µ—Ç</p>';
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π:', error);
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ localStorage –∫–∞–∫ –±—ç–∫–∞–ø
        const messages = JSON.parse(localStorage.getItem('pendingMessages') || '[]');
        if (messages.length > 0) {
            messagesList.innerHTML = messages.map((message, index) => `
                <div class="message-item">
                    <button class="approve-btn" onclick="approveMessage(${index})">‚úÖ</button>
                    <button class="delete-btn" onclick="deleteMessage(${index})">‚ùå</button>
                    <div class="message-time">üìÖ ${message.date}</div>
                    <div class="message-field"><strong>üë§ –ê–≤—Ç–æ—Ä:</strong> ${message.author}</div>
                    <div class="message-field"><strong>üìù –ó–∞–≥–æ–ª–æ–≤–æ–∫:</strong> ${message.title}</div>
                    <div class="message-content"><strong>üí¨ –¢–µ–∫—Å—Ç:</strong> ${message.content}</div>
                </div>
            `).join('');
        } else {
            messagesList.innerHTML = '<p style="color: #FF0;">–°–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –Ω–µ—Ç</p>';
        }
    }
}

// –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
function deleteOrder(index) {
    if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∑–∞–∫–∞–∑?')) {
        const orders = JSON.parse(localStorage.getItem('siteOrders') || '[]');
        orders.splice(index, 1);
        localStorage.setItem('siteOrders', JSON.stringify(orders));
        loadOrders();
    }
}

// –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
function deleteMessage(index) {
    if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ?')) {
        const messages = JSON.parse(localStorage.getItem('pendingMessages') || '[]');
        messages.splice(index, 1);
        localStorage.setItem('pendingMessages', JSON.stringify(messages));
        loadMessages();
    }
}

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', () => {
    loadOrders();
    loadMessages();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
    setInterval(() => {
        loadOrders();
        loadMessages();
    }, 30000);
});

// –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤
function clearAllOrders() {
    if (confirm('–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∑–∞–∫–∞–∑—ã? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!')) {
        localStorage.removeItem('siteOrders');
        loadOrders();
    }
}

// –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
function clearAllMessages() {
    if (confirm('–£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!')) {
        localStorage.removeItem('pendingMessages');
        loadMessages();
    }
}

// –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ–≥–æ
function clearAll() {
    if (confirm('–£–¥–∞–ª–∏—Ç—å –í–°–Å - –∑–∞–∫–∞–∑—ã –∏ —Å–æ–æ–±—â–µ–Ω–∏—è? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!')) {
        localStorage.removeItem('siteOrders');
        localStorage.removeItem('pendingMessages');
        loadOrders();
        loadMessages();
    }
}

// –û–¥–æ–±—Ä–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
function approveMessage(index) {
    if (confirm('–û–¥–æ–±—Ä–∏—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ?')) {
        const messages = JSON.parse(localStorage.getItem('pendingMessages') || '[]');
        const message = messages[index];
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≤ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã —Ñ–æ—Ä—É–º–∞
        const topics = JSON.parse(localStorage.getItem('forumTopics') || '[]');
        topics.push(message);
        localStorage.setItem('forumTopics', JSON.stringify(topics));
        
        // –£–¥–∞–ª—è–µ–º –∏–∑ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
        messages.splice(index, 1);
        localStorage.setItem('pendingMessages', JSON.stringify(messages));
        
        loadMessages();
        alert('‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ–¥–æ–±—Ä–µ–Ω–æ –∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ –Ω–∞ —Ñ–æ—Ä—É–º–µ!');
    }
}

// –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
function rejectMessage(index) {
    if (confirm('–û—Ç–∫–ª–æ–Ω–∏—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ?')) {
        const messages = JSON.parse(localStorage.getItem('pendingMessages') || '[]');
        messages.splice(index, 1);
        localStorage.setItem('pendingMessages', JSON.stringify(messages));
        loadMessages();
        alert('‚ùå –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ');
    }
}
</script>

</body>
</html>
